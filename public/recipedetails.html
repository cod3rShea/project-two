<!DOCTYPE html>
<html lang="en">

<head>
    <title>Recipe</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="stylesheets/reset.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/lumen/bootstrap.min.css">
    <link href="stylesheets/owl.css" rel="stylesheet">
    <link href="stylesheets/style.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <!-- ICON LIBRARY -->
    <script src="https://kit.fontawesome.com/d5fa5f8504.js" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>

<body>
    <nav class="navbar navbar-default">
        <div class="container-fluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
              aria-expanded="false" aria-controls="navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand auce-red" href="/">All You Can Eat</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse" aria-expanded="false" style="height: 1px;">
            <ul class="nav navbar-nav">
              <li class="active"><a href="/search">Search</a></li>
              <li class="active"><a href="/favorites">Wall of Favs</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li>
                <a class="navbar-brand" href="/logout">
                  Logout
                </a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="recipe">
                <div class="favorites-container">
                    <img class="recipe-img img-fluid img-thumbnail">
                    <i class="far fa-heart"></i>
                </div>

                <h1 class="recipe-name"></h1>
                <div class="ingrediants-sidebar">
                    <ul>

                    </ul>
                </div>
                <div>
                    <h2>INSTRUCTIONS</h2>
                    <div id="slider" class="owl-carousel owl-theme"></div>
                </div>

            </div>
        </div>
    </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">

        str = window.location.href;
        var res = str.split("=").pop();

        var recipeId = res;

        var apiKey = "4cc7196cb8a248819a49fe3043bfb694";

        var queryURL = "https://api.spoonacular.com/recipes/" + recipeId + "/information?apiKey=" + apiKey;
        // AJAX to pull in API URL and "get" method
        $.ajax({
            url: queryURL,
            method: "GET"
        })
            // create function to pull recipe search results
            .then(function (result) {

                jQuery('.recipe-img').attr('src', result.image).attr('data', recipeId);
                jQuery('.recipe-name').html(result.title).append('<i class="fas fa-sort-down"></i>');

                for (i = 0; i < result.extendedIngredients.length; i++) {

                    jQuery('.ingrediants-sidebar ul').append("<li>" + result.extendedIngredients[i].original + "</li>");

                }

                jQuery('h1.recipe-name').on('click', function () {
                    jQuery(this).toggleClass('closed')
                    jQuery('.ingrediants-sidebar').toggle();

                });

                for (j = 0; j < result.analyzedInstructions[0].steps.length; j++) {
                    jQuery('#slider').append("<div class='item'> <p>" + result.analyzedInstructions[0].steps[j].step + "</p></div>");
                }

                jQuery(document).ready(function () {
                    jQuery('.owl-carousel').owlCarousel({
                        loop: true,
                        margin: 0,
                        items: 1,
                        dots: true,
                        nav: true,
                        autoplay: false,
                        autoplayTimeout: 7000,
                        autoplayHoverPause: true,
                        autoHeight: true
                    });

                    var favoriteID = jQuery('recipe-img').attr('data');

         


                    $.get("/api/user_data").then(function(data) {
                      var test = data.id;

                      jQuery(".recipe-img").on("click", function (event) {
                            event.preventDefault();
                            alert(recipeId);
                            alert(test);
                        });

                    });

      

                });

            });
    </script>
    <script src="js/owl.carousel.js"></script>
    <script src="js/owl.navigation.js"></script>

</body>

</html>